{% extends 'base.html' %}

{% block title %} ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¯Ø« - {{ event.name }} {% endblock %}

{% block content %}
<div class="container my-3">
    <!-- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="card border-0 shadow-lg rounded-4 p-4" 
        style="background: linear-gradient(135deg, #6c757d, #212529, #212529); color: white;">
        
        <!-- Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø­Ø¯Ø« -->
        <div class="text-center">
            <h2 class="fw-bold display-6">{{ event.name }}</h2>
            <p class="lead">{{ event.description }}</p>
        </div>

        <hr class="border-white opacity-50">

        <!-- ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¯Ø« Ø¯Ø§Ø®Ù„ Ø¨Ø·Ø§Ù‚Ø© ÙˆØ§Ø­Ø¯Ø© -->
        <div class="d-flex flex-wrap justify-content-between align-items-center text-center text-md-start">
            <p class="fs-5 m-0"><i class="bi bi-person-fill"></i> Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ {{ event.student_count }} </p>
            <p class="fs-5 m-0"><i class="bi bi-calendar-event"></i> ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¯Ø«: {{ event.event_date|date:"d M Y" }}</p>
        </div>
    </div>

    <!-- ğŸ› ï¸ Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª -->
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-center my-3 gap-2">
        <h5 class="text-muted"><i class="bi bi-list-check"></i> Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</h5>
        <div>
            <form method="POST" action="{% url 'event_delete' event.pk %}" class="d-inline">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger text-white rounded-pill shadow-sm mx-2" onclick="return confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¯Ø«ØŸ')">
                    <i class="bi bi-trash"></i> Ø­Ø°Ù Ø§Ù„Ø­Ø¯Ø« 
                </button>
            </form>
            <a href="{% url 'event_update' event.pk %}" class="btn btn-primary rounded-pill shadow-sm">
                <i class="bi bi-pencil-square"></i> ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø¯Ø«
            </a>
        </div>
    </div>
    
    <!-- âš ï¸ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª -->
    {% if messages %}
        <div class="alert-container my-3">
            {% for message in messages %}
                <div class="alert {% if message.tags == 'success' %}alert-success{% elif message.tags == 'error' %}alert-danger{% endif %} shadow-sm">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <div class="table-responsive">
        <table id="usersTable" class="table table-responsive table-striped table-hover border align-middle">
            <thead class="table-dark align-middle">
                <tr>
                    <th></th>
                    <th>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                    <th>Ø§Ù„Ø¬Ù†Ø³</th>
                    <th>Ø§Ù„ØµÙ</th>
                    <th>Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</th>
                    <th>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</th>
                    <th>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ù†Ø¬Ø²Ø©</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for student in students %}
                <tr>
                    <td>
                        <div class="rounded-circle overflow-hidden" style="width: 60px; height: 60px;">
                            <img src="{{ student.profile_picture.url }}" alt="ØµÙˆØ±Ø© Ø§Ù„Ø·Ø§Ù„Ø¨" class="w-100 h-100 object-fit-cover">
                        </div>
                    </td>
                    <td class="fw-bold">{{ student.user.full_name }}</td>
                    <td>{{ student.gender }}</td>
                    <td>{{ student.grade }}</td>
                    <td>{{ student.school }}</td>
                    <td>{{ student.education_department }}</td>
                    <td>{{ student.total_count }}</td>
                    {{event.students.all}}
                    <td><a href="{% url 'student_event_tasks_detail' pk=event.id student_id=student.id %}" class="btn btn-outline-primary">
                        <i class="bi bi-eye"></i> Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‡Ø§Ù…
                    </a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="text-center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø§Ø¨ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¯Ø«.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
